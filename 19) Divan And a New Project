#include <bits/stdc++.h>
using namespace std;
int main(){
    long long t;
    cin>>t;
    while (t--){
        long long n;
        cin>>n;
        vector<vector<long long>> store(n,vector<long long>(2,0));
        for (long long i=0;i<n;i++){
            cin>>store[i][0];
            store[i][1]=i+1;
        }
        vector<vector<long long>> visitFreq(n,vector<long long>(2,0));
        visitFreq=store;
        sort(store.rbegin(), store.rend());
        vector<long long> coordinate(n+1,0);
        long long a=0;
        long long d=1;
        long long f=1;
        long long sum=0;
        for (long long i=0;i<n;i++){
            long long buildingNo=store[i][1];
            a=a+d*f;
            coordinate[buildingNo]=a;
            d=d+1;
            f=-f;
            sum=sum+abs(coordinate[buildingNo])*2*visitFreq[buildingNo-1][0];
        }
        cout<<sum<<endl;
        for (long long i=0;i<n+1;i++){
            cout<<coordinate[i]<<" ";
        }

        cout<<endl;

        //T.C.:- O(nlogn)
        //S.C.:- O(n*2)
    }
    return 0;
}
